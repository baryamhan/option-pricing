<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Opsiyon Fiyatlama</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <h1>Opsiyon Fiyatlama</h1>

    <!-- Dayanak Varlık Seçimi -->
    <label for="asset">Dayanak Varlık:</label>
    <select id="asset" onchange="fetchStockPrice()">
        <option value="AKBNK.IS">AKBNK</option>
        <option value="ALARK.IS">ALARK</option>
        <option value="ARCLK.IS">ARCLK</option>
        <option value="ASELS.IS">ASELS</option>
        <option value="BIMAS.IS">BIMAS</option>
        <option value="EKGYO.IS">EKGYO</option>
        <option value="ENKAI.IS">ENKAI</option>
        <option value="EREGL.IS">EREGL</option>
        <option value="FROTO.IS">FROTO</option>
        <option value="GARAN.IS">GARAN</option>
        <option value="HALKB.IS">HALKB</option>
        <option value="ISCTR.IS">ISCTR</option>
        <option value="KCHOL.IS">KCHOL</option>
        <option value="KRDMD.IS">KRDMD</option>
        <option value="PETKM.IS">PETKM</option>
        <option value="PGSUS.IS">PGSUS</option>
        <option value="SAHOL.IS">SAHOL</option>
        <option value="SISE.IS">SISE</option>
        <option value="TAVHL.IS">TAVHL</option>
        <option value="TCELL.IS">TCELL</option>
        <option value="THYAO.IS">THYAO</option>
        <option value="TOASO.IS">TOASO</option>
        <option value="TTKOM.IS">TTKOM</option>
        <option value="TUPRS.IS">TUPRS</option>
        <option value="USDTRY=X">USDTRY</option>
        <option value="VAKBN.IS">VAKBN</option>
        <option value="XU030.IS">XU030</option>
        <option value="YKBNK.IS">YKBNK</option>
    </select>

    <!-- Call/Put Seçimi -->
    <label for="option_type">Opsiyon Türü:</label>
    <select id="option_type">
        <option value="call">Call</option>
        <option value="put">Put</option>
    </select>

    <!-- Spot Fiyat (Otomatik Güncellenecek) -->
    <label for="spot">Spot Fiyat:</label>
    <input type="number" id="spot" readonly />

    <!-- Strike Fiyatı -->
    <label for="strike">Kullanım Fiyatı (Strike):</label>
    <input type="number" id="strike" placeholder="Örn: 5000" />

    <!-- Vade Sonu Tarihi -->
    <label for="expiry">Vade Sonu Tarihi:</label>
    <input type="date" id="expiry" />

    <button onclick="calculateOption()">Hesapla</button>

    <div id="result"></div>

    <script>
        async function fetchStockPrice() {
            const asset = document.getElementById("asset").value;
            const url = `https://apidojo-yahoo-finance-v1.p.rapidapi.com/market/v2/get-quotes?region=US&symbols=${asset}`;

            try {
                const response = await fetch(url, {
                    method: "GET",
                    headers: {
                        "X-RapidAPI-Key": "373fca70a5msh77cea3971d38250p18a642jsn57bfae126a2e",
                        "X-RapidAPI-Host": "apidojo-yahoo-finance-v1.p.rapidapi.com"
                    }
                });

                const data = await response.json();
                const stockPrice = data.quoteResponse.result[0].regularMarketPrice;

                // Spot fiyatı güncelle
                document.getElementById("spot").value = stockPrice.toFixed(2);
            } catch (error) {
                console.error("Fiyat çekme hatası:", error);
                document.getElementById("spot").value = "Hata";
            }
        }

        function calculateOption() {
            const asset = document.getElementById("asset").value;
            const optionType = document.getElementById("option_type").value;
            const spot = parseFloat(document.getElementById("spot").value);
            const strike = parseFloat(document.getElementById("strike").value);
            const expiry = document.getElementById("expiry").value;

            if (!asset || !optionType || !spot || !strike || !expiry) {
                alert("Lütfen tüm alanları doldurun.");
                return;
            }

            document.getElementById("result").innerText = `Seçiminiz: ${asset}, ${optionType.toUpperCase()}, Spot: ${spot}, Strike: ${strike}, Vade: ${expiry}`;
        }
    </script>

</body>
</html>
